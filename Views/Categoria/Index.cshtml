@model IEnumerable<mi_ferreteria.Models.Categoria>
@{
    ViewData["Title"] = "Categorías";
}
<h2 class="mb-3">Categorías</h2>
<div class="text-center mb-4">
    <a asp-action="Create" class="btn btn-primary btn-lg btn-cta">Crear categoría</a>
 </div>
@if (Model == null || !Model.Any())
{
    <div class="alert alert-info">No hay categorías.</div>
}
else
{
    <div class="table-responsive">
        <table class="table table-striped table-hover table-bordered align-middle table-products">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Padre</th>
                    <th class="text-end">Acciones</th>
                </tr>
            </thead>
            <tbody>
            @foreach (var c in Model)
            {
                <tr class="clickable-row" data-href="@Url.Action("Edit","Categoria", new { id = c.Id })">
                    <td>@c.Id</td>
                    <td>@c.Nombre</td>
                    <td>@c.IdPadre</td>
                    <td class="text-end">
                        <a asp-action="Edit" asp-route-id="@c.Id" class="btn btn-sm btn-outline-primary">Editar</a>
                        <a asp-action="Delete" asp-route-id="@c.Id" class="btn btn-sm btn-outline-danger">Eliminar</a>
                    </td>
                </tr>
            }
            </tbody>
        </table>
    </div>
}

@section Scripts {
<script>
document.addEventListener('DOMContentLoaded', function(){
  document.querySelectorAll('table.table-products tbody tr.clickable-row').forEach(function(tr){
    tr.addEventListener('click', function(e){
      var t = e.target;
      if (t && t.closest && (t.closest('a') || t.closest('button'))) return;
      var href = this.getAttribute('data-href');
      if (href) window.location.href = href;
    });
  });
});
</script>
}
